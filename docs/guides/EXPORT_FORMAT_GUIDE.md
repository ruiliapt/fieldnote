# 导出格式说明

## 新增功能：词对齐文本导出

程序现在支持生成标准语言学格式的对齐文本，可以直接复制到 Word 或其他文档编辑器中。

## 📝 格式说明

### 标准三行格式

每条语料按照以下格式输出：

```
(例句编号)
    原文词1    原文词2    原文词3    ...
    注释1      注释2      注释3      ...
    '中文翻译'
    [备注: 如果有备注]
```

### 对齐规则

1. **自动词对齐**：原文和词汇分解按空格分词后，会自动对齐
2. **宽度计算**：考虑中文字符占2个宽度，英文字符占1个宽度
3. **等宽字体**：显示区域使用 Courier New 等宽字体，确保对齐效果

## 📋 使用步骤

### 方法1：生成对齐文本（推荐）

1. 在"导出"标签页，选择要导出的语料范围
2. 点击绿色按钮 **"生成对齐文本（可复制到Word）"**
3. 查看下方文本显示区域中的格式化结果
4. 点击 **"复制到剪贴板"** 按钮
5. 打开 Word，粘贴内容
6. 在 Word 中设置字体为 **Courier New** 或 **Consolas** 以保持对齐

### 方法2：导出到 Word 文档

1. 点击 **"导出到Word文档"** 按钮
2. 选择保存位置
3. 生成的 Word 文档会使用表格格式

## 🎯 格式示例

### 输入数据

- **原文**: `ŋa˧ tə˥ tɕʰi˥ fan˨˩`
- **词汇分解**: `1SG CLF eat rice`
- **翻译**: `我吃饭`

### 输出格式

```
(CJ001)
    ŋa˧     tə˥   tɕʰi˥  fan˨˩  
    1SG     CLF   eat    rice   
    '我吃饭'
```

### 复杂示例（中英混合）

**输入**：
- 原文: `今天 天气 很 好`
- 注释: `today weather very good`

**输出**：
```
(001)
    今天      天气      很    好    
    today    weather  very  good  
    '今天天气很好'
```

## 💡 使用技巧

### 1. 分词建议

为了获得最佳对齐效果，在录入数据时：

- **原文和注释都要用空格分词**
- 确保词数相同
- 每个原文词对应一个注释

**推荐格式**：
```
原文: 我 吃 了 饭
注释: 1SG eat PERF rice
```

**不推荐**（无法对齐）：
```
原文: 我吃了饭
注释: 1SG eat PERF rice
```

### 2. Word 中的最佳实践

复制到 Word 后：

1. **选中全部文本**
2. **设置字体**：Courier New 或 Consolas
3. **字号**：10-11pt
4. **行距**：1.0 或 1.15
5. **段落间距**：段后 6-12pt

### 3. 特殊字符处理

- ✅ 完全支持 IPA 音标
- ✅ 支持中文、藏文等 Unicode 字符
- ✅ 自动计算显示宽度，确保对齐

### 4. 批量处理

- 可以一次性导出所有语料
- 也可以先检索，然后只导出搜索结果
- 每条语料之间用空行分隔

## 📐 对齐算法说明

程序使用智能对齐算法：

```python
# 示例：对齐两个词列表
原文: ['你好', 'world']
注释: ['hello', '世界']

# 计算显示宽度
你好: 4 (2个中文字符 × 2)
world: 5 (5个英文字符 × 1)
hello: 5
世界: 4

# 对齐后
你好    world  
hello  世界   
```

## 🔧 自定义选项

### 显示编号

- ☑️ 显示编号：显示例句编号或 ID
- ☐ 显示编号：不显示编号，直接开始原文

### 导出范围

- **导出所有语料**：导出数据库中的所有记录
- **仅导出搜索结果**：只导出当前搜索到的语料

## 📚 参考格式

本工具生成的格式参考了语言学界的标准注释规范（Leipzig Glossing Rules）：

```
(1) 例句编号
    原文行（按词分隔）
    词汇注释行（形态学分析）
    '自由翻译'
```

## ❓ 常见问题

### Q: 为什么对齐不整齐？

**A**: 请确保：
1. 原文和注释都用空格分词
2. 词数相同
3. 在 Word 中使用等宽字体

### Q: 如何处理长句子？

**A**: 可以手动分行：
```
原文第一部分
注释第一部分

原文第二部分
注释第二部分
```

### Q: 支持其他格式吗？

**A**: 当前支持：
- ✅ 纯文本格式（可复制）
- ✅ Word 表格格式
- 🔜 LaTeX 格式（计划中）
- 🔜 HTML 格式（计划中）

## 🎨 Word 样式建议

### 推荐字体

1. **Courier New** (最推荐)
2. **Consolas**
3. **Monaco**
4. **Menlo**
5. **Source Code Pro**

### 推荐配色（可选）

- 例句编号：**灰色** (#666666)
- 原文行：**黑色** (#000000)
- 注释行：**深蓝** (#0066CC)
- 翻译行：**绿色** (#006600)

---

**提示**：如需更多帮助，请参考 [README.md](README.md) 或 [QUICKSTART.md](QUICKSTART.md)

